What if Rust, on [GameTank](https://www.clydeshaffer.com/gametank/)?

# What?

The GameTank is a retro-inspired game console running dual 6502 processors. 
It has 128x128 composite out, with up to 200 colors. It's kind of like if Pico8 were real hardware -- 
with real hardware limitations, and neat tricks!

# Why?

I like Rust, I like GameTank. What if, both?

# How?

Rust compiles via LLVM. There is [LLVM-MOS](https://github.com/llvm-mos/llvm-mos/blob/main/README.md), 
which can target the 6502. Throw all that together and create some linker scripts, we _should_ have a stew.

# GameTank SDK (Rust)

This SDK produces 2MB GameTank ROMs (`.gtr`) to be uploaded to physical cartridges, or to be played in the emulator.

Bundled with the SDK are development tools:


| tool    | description |
| ------- | ----------- |
| `gtld`  | used to flash `.gtr` ROMs to cartridges, and to update the flasher firmware. |
| `gte`   | the rusty gametank emulator. It's not quite as featureful as the C++ version, but it's easier to install, useful for basic debugging/testing |
| `gtrom` | converts the elf binary generated by `cargo build` into a `.gtr`. In the future might make a `.gtr2`, which would include metadata and debug info, which could be interpreted by `gte` or `gtld`. |
| `gtgo`  | intended to be a "one-stop-shop" for development, this tui includes tools for building |
    
development is done in vscode (sry), and there's a `.vscode/settings.json` for the linked projects for rust analyzer.
  

## Requirements




  

### Windows

  

~~please just install wsl, please - you'll be doing everyone a favor~~



  

but if you _must_ use windows...

first step is to install Visual Studio Community 2022, and enable the "Desktop development with C++" workload during the install process.

See: https://rust-lang.github.io/rustup/installation/windows-msvc.html#walkthrough-installing-visual-studio-2022

  

then you can install rust and docker through powershell

  

- `winget install Rustlang.Rustup`

- `winget install Docker.DockerDesktop`

  

if you have vscode open, restart vscode completely (because windows things)

  

finally: cry, because ballmer was right (developer experience matters, and this one is dreadful)




mkdir rom/target
mkdir rom/target/asm

➜ podman run -d --name gametank -v $(pwd):/workspace:z --replace rust-mos:gte sleep infinity
➜ podman exec -it -w /workspace gametank /bin/zsh

➜ find . -name "*.asm" -exec bash -c 'filename=$(basename "{}" .asm); echo "Assembling $filename..."; llvm-mc --filetype=obj -triple=mos -mcpu=mosw65c02 "{}" -o "target/asm/$filename.o"' \;


➜  bash -c 'llvm-ar rcs target/asm/libasm.a target/asm/*.o && rm target/asm/*.o'

➜ llvm-objdump -s target/mos-unknown-none/release/main

➜ cargo +mos build --release -Z build-std=core --target mos-unknown-none


---

IMPORTANT

After just/cargo build-ing, use gtrom to pack elf into a raw binary
